&НаСервере
Процедура ИмпортДанныхНаСервере(ИмяФайла)
Текст = Новый ТекстовыйДокумент();
Текст.Прочитать(ИмяФайла);

КоличествоСтрок = Текст.КоличествоСтрок();

Для Счетчик = 2 по КоличествоСтрок Цикл
ТекСтрока = Текст.ПолучитьСтроку(Счетчик);
МассивСтр = СтрРазделить(ТекСтрока,";");
ИнфНос = Справочники.Товар.СоздатьЭлемент();
ИнфНос.Код = МассивСтр[0];
ИнфНос.Наименование = МассивСтр[1];
ИнфНос.Количество = МассивСтр[2];
ИнфНос.Владелец = Справочники.Категория.НайтиПоНаименованию(МассивСтр[3]);
ИнфНос.Цена = МассивСтр[4];
ИнфНос.Записать();
КонецЦикла;
Сообщить ("Импорт успешно выполнен");
КонецПроцедуры

&НаКлиенте
Процедура Импорт(Команда)
ДиалогВыбора = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);

ДиалогВыбора.Заголовок = "Выберите файл";

Если ДиалогВыбора.Выбрать() Тогда

ИмяФайла = ДиалогВыбора.ПолноеИмяФайла;
КонецЕсли;
ИмпортДанныхНаСервере(ИмяФайла)

КонецПроцедуры

&НаСервере
Процедура ЭкспортНаСервере(ИмяФайла)
Код = Метаданные.Справочники.Товар.СтандартныеРеквизиты.Код.Представление();
Наименование = Метаданные.Справочники.Товар.СтандартныеРеквизиты.Наименование.Представление();
Количество = Метаданные.Справочники.Товар.Реквизиты.Количество.Представление();
Цена = Метаданные.Справочники.Товар.Реквизиты.Цена.Представление();
Текст = новый ЗаписьТекста(ИмяФайла);
Выборка = Справочники.Товар.Выбрать();
Текст.ЗаписатьСтроку("Код"+";"+ "Наименование"+";"+ "Количество"+";"+ "Цена");
Пока Выборка.Следующий() Цикл
Текст.ЗаписатьСтроку (Выборка.Код + ";" + Выборка.Наименование +";"+ Выборка.Количество +";"+ Выборка.Цена+ ";" + Выборка.Категория +";"+ Выборка.Цена);
КонецЦикла;
Сообщить("Экспорт выполнен");
Текст.Закрыть();

КонецПроцедуры

&НаКлиенте
Процедура Ээкспорт(Команда)
ДиалогВыбора = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
ДиалогВыбора.Заголовок = "Выберите файл";
Если ДиалогВыбора.Выбрать() Тогда
ИмяФайла = ДиалогВыбора.ПолноеИмяФайла;
КонецЕсли;
ЭкспортНаСервере(ИмяФайла);
КонецПроцедуры
